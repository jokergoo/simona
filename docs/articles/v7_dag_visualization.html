<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualize DAGs • simona</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Visualize DAGs">
<meta property="og:description" content="simona">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simona</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v1_dag.html">ontology_DAG: a class for ontologies</a>
    </li>
    <li>
      <a href="../articles/v2_GO.html">Gene Ontology</a>
    </li>
    <li>
      <a href="../articles/v3_import.html">Import ontology files</a>
    </li>
    <li>
      <a href="../articles/v4_information_content.html">Information content</a>
    </li>
    <li>
      <a href="../articles/v5_term_similarity.html">Term similarity</a>
    </li>
    <li>
      <a href="../articles/v6_group_similarity.html">Similarity between two groups of terms</a>
    </li>
    <li>
      <a href="../articles/v7_dag_visualization.html">Visualize DAGs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/simona/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="v7_dag_visualization_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="v7_dag_visualization_files/viz-1.8.2/viz.js"></script><link href="v7_dag_visualization_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="v7_dag_visualization_files/grViz-binding-1.0.10/grViz.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Visualize DAGs</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu ( <a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a> )</h4>
            
            <h4 data-toc-skip class="date">2023-08-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/simona/blob/HEAD/vignettes/v7_dag_visualization.Rmd" class="external-link"><code>vignettes/v7_dag_visualization.Rmd</code></a></small>
      <div class="hidden name"><code>v7_dag_visualization.Rmd</code></div>

    </div>

    
    
<p>There are two functions for visualizing DAGs. <code><a href="../reference/dag_viz.html">dag_graphviz()</a></code> uses the <strong>DiagrammeR</strong> package to visualize small DAGs as HTML widgets. <code><a href="../reference/dag_viz.html">dag_circular_viz()</a></code> uses a circular layout for huge DAGs.</p>
<div class="section level2">
<h2 id="small-dags">Small DAGs<a class="anchor" aria-label="anchor" href="#small-dags"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/simona" class="external-link">simona</a></span><span class="op">)</span></span>
<span><span class="va">parents</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span></span>
<span><span class="va">children</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span></span>
<span><span class="va">dag_small</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_ontology_DAG.html">create_ontology_DAG</a></span><span class="op">(</span><span class="va">parents</span>, <span class="va">children</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dag_viz.html">dag_graphviz</a></span><span class="op">(</span><span class="va">dag_small</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ee5a44f11e97e193a252" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ee5a44f11e97e193a252">{"x":{"diagram":"digraph {\n  graph [overlap = true]\n\n  node [fontname=Helvetical]\n  \"a\" [color=\"black\", style=\"solid\", shape=\"box\", fontsize=10, fontcolor=\"black\"];\n  \"b\" [color=\"black\", style=\"solid\", shape=\"box\", fontsize=10, fontcolor=\"black\"];\n  \"c\" [color=\"black\", style=\"solid\", shape=\"box\", fontsize=10, fontcolor=\"black\"];\n  \"d\" [color=\"black\", style=\"solid\", shape=\"box\", fontsize=10, fontcolor=\"black\"];\n  \"e\" [color=\"black\", style=\"solid\", shape=\"box\", fontsize=10, fontcolor=\"black\"];\n  \"f\" [color=\"black\", style=\"solid\", shape=\"box\", fontsize=10, fontcolor=\"black\"];\n\n  edge [dir=\"back\"]\n  \"a\" -> \"b\";\n  \"a\" -> \"c\";\n  \"b\" -> \"c\";\n  \"b\" -> \"d\";\n  \"c\" -> \"e\";\n  \"d\" -> \"f\";\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>There are several graphical parameters for controlling nodes in the DAG.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">color</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">colors</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">shape</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"polygon"</span>, <span class="st">"box"</span>, <span class="st">"oval"</span>, <span class="st">"egg"</span>, <span class="st">"diamond"</span>, <span class="st">"parallelogram"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/dag_viz.html">dag_graphviz</a></span><span class="op">(</span><span class="va">dag_small</span>, color <span class="op">=</span> <span class="va">color</span>, shape <span class="op">=</span> <span class="va">shape</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5c8472a709491f599d81" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-5c8472a709491f599d81">{"x":{"diagram":"digraph {\n  graph [overlap = true]\n\n  node [fontname=Helvetical]\n  \"a\" [color=\"slategray4\", style=\"solid\", shape=\"polygon\", fontsize=10, fontcolor=\"black\"];\n  \"b\" [color=\"plum2\", style=\"solid\", shape=\"box\", fontsize=10, fontcolor=\"black\"];\n  \"c\" [color=\"lightcyan3\", style=\"solid\", shape=\"oval\", fontsize=10, fontcolor=\"black\"];\n  \"d\" [color=\"grey78\", style=\"solid\", shape=\"egg\", fontsize=10, fontcolor=\"black\"];\n  \"e\" [color=\"darkorange3\", style=\"solid\", shape=\"diamond\", fontsize=10, fontcolor=\"black\"];\n  \"f\" [color=\"violetred4\", style=\"solid\", shape=\"parallelogram\", fontsize=10, fontcolor=\"black\"];\n\n  edge [dir=\"back\"]\n  \"a\" -> \"b\";\n  \"a\" -> \"c\";\n  \"b\" -> \"c\";\n  \"b\" -> \"d\";\n  \"c\" -> \"e\";\n  \"d\" -> \"f\";\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>The DOT code can be obtained with <code><a href="../reference/dag_viz.html">dag_as_DOT()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dag_viz.html">dag_as_DOT</a></span><span class="op">(</span><span class="va">dag_small</span>, color <span class="op">=</span> <span class="va">color</span>, shape <span class="op">=</span> <span class="va">shape</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## digraph {</span></span>
<span><span class="co">##   graph [overlap = true]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   node [fontname=Helvetical]</span></span>
<span><span class="co">##   "a" [color="slategray4", style="solid", shape="polygon", fontsize=10, fontcolor="black"];</span></span>
<span><span class="co">##   "b" [color="plum2", style="solid", shape="box", fontsize=10, fontcolor="black"];</span></span>
<span><span class="co">##   "c" [color="lightcyan3", style="solid", shape="oval", fontsize=10, fontcolor="black"];</span></span>
<span><span class="co">##   "d" [color="grey78", style="solid", shape="egg", fontsize=10, fontcolor="black"];</span></span>
<span><span class="co">##   "e" [color="darkorange3", style="solid", shape="diamond", fontsize=10, fontcolor="black"];</span></span>
<span><span class="co">##   "f" [color="violetred4", style="solid", shape="parallelogram", fontsize=10, fontcolor="black"];</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   edge [dir="back"]</span></span>
<span><span class="co">##   "a" -&gt; "b";</span></span>
<span><span class="co">##   "a" -&gt; "c";</span></span>
<span><span class="co">##   "b" -&gt; "c";</span></span>
<span><span class="co">##   "b" -&gt; "d";</span></span>
<span><span class="co">##   "c" -&gt; "e";</span></span>
<span><span class="co">##   "d" -&gt; "f";</span></span>
<span><span class="co">## }</span></span></code></pre>
<p>Following is an example of visualizing all upstream terms of a GO term. Note <code>dag[, "GO:0010228"]</code> returns a sub-DAG of all upstream terms of <code>GO:0010228</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_ontology_DAG_from_GO_db.html">create_ontology_DAG_from_GO_db</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/dag_viz.html">dag_graphviz</a></span><span class="op">(</span><span class="va">dag</span><span class="op">[</span>, <span class="st">"GO:0010228"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ac9dd303965dd930875f" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac9dd303965dd930875f">{"x":{"diagram":"digraph {\n  graph [overlap = true]\n\n  node [fontname=Helvetical]\n  \"GO:0000003\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"reproduction\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0003006\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"developmental process involved in reproduction\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0007275\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"multicellular organism development\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0008150\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"biological_process\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0009791\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"post-embryonic development\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0010228\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"vegetative to reproductive phase transition of meristem\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0022414\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"reproductive process\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0032501\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"multicellular organismal process\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0032502\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"developmental process\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0048608\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"reproductive structure development\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0048731\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"system development\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0048856\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"anatomical structure development\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0061458\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"reproductive system development\", fontsize=10, fontcolor=\"black\"];\n\n  edge [dir=\"back\"]\n  \"GO:0000003\" -> \"GO:0022414\" [color=\"#DF536B\", style=\"solid\", tooltip=\"part_of\"];\n  \"GO:0003006\" -> \"GO:0010228\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0003006\" -> \"GO:0048608\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0007275\" -> \"GO:0009791\" [color=\"#DF536B\", style=\"solid\", tooltip=\"part_of\"];\n  \"GO:0007275\" -> \"GO:0048731\" [color=\"#DF536B\", style=\"solid\", tooltip=\"part_of\"];\n  \"GO:0008150\" -> \"GO:0000003\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0008150\" -> \"GO:0022414\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0008150\" -> \"GO:0032501\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0008150\" -> \"GO:0032502\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0009791\" -> \"GO:0010228\" [color=\"#DF536B\", style=\"solid\", tooltip=\"part_of\"];\n  \"GO:0022414\" -> \"GO:0003006\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0032501\" -> \"GO:0007275\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0032501\" -> \"GO:0009791\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0032502\" -> \"GO:0003006\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0032502\" -> \"GO:0048856\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0048608\" -> \"GO:0010228\" [color=\"#DF536B\", style=\"solid\", tooltip=\"part_of\"];\n  \"GO:0048731\" -> \"GO:0061458\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0048856\" -> \"GO:0007275\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0048856\" -> \"GO:0048608\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0048856\" -> \"GO:0048731\" [color=\"#000000\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0061458\" -> \"GO:0048608\" [color=\"#DF536B\", style=\"solid\", tooltip=\"part_of\"];\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Edge attributes should be set as a named vector where names correspond to all relation types.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dag_viz.html">dag_graphviz</a></span><span class="op">(</span><span class="va">dag</span><span class="op">[</span>, <span class="st">"GO:0010228"</span><span class="op">]</span>, </span>
<span>  edge_color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"is_a"</span> <span class="op">=</span> <span class="st">"purple"</span>, <span class="st">"part_of"</span> <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span>,</span>
<span>  edge_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"is_a"</span> <span class="op">=</span> <span class="st">"solid"</span>, <span class="st">"part_of"</span> <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">800</span>, height <span class="op">=</span> <span class="fl">800</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-a93c45938bc6526ac9c9" style="width:800px;height:800px;" class="grViz html-widget "></div>
<script type="application/json" data-for="htmlwidget-a93c45938bc6526ac9c9">{"x":{"diagram":"digraph {\n  graph [overlap = true]\n\n  node [fontname=Helvetical]\n  \"GO:0000003\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"reproduction\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0003006\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"developmental process involved in reproduction\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0007275\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"multicellular organism development\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0008150\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"biological_process\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0009791\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"post-embryonic development\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0010228\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"vegetative to reproductive phase transition of meristem\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0022414\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"reproductive process\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0032501\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"multicellular organismal process\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0032502\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"developmental process\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0048608\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"reproductive structure development\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0048731\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"system development\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0048856\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"anatomical structure development\", fontsize=10, fontcolor=\"black\"];\n  \"GO:0061458\" [color=\"black\", style=\"solid\", shape=\"box\", tooltip=\"reproductive system development\", fontsize=10, fontcolor=\"black\"];\n\n  edge [dir=\"back\"]\n  \"GO:0000003\" -> \"GO:0022414\" [color=\"darkgreen\", style=\"dashed\", tooltip=\"part_of\"];\n  \"GO:0003006\" -> \"GO:0010228\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0003006\" -> \"GO:0048608\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0007275\" -> \"GO:0009791\" [color=\"darkgreen\", style=\"dashed\", tooltip=\"part_of\"];\n  \"GO:0007275\" -> \"GO:0048731\" [color=\"darkgreen\", style=\"dashed\", tooltip=\"part_of\"];\n  \"GO:0008150\" -> \"GO:0000003\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0008150\" -> \"GO:0022414\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0008150\" -> \"GO:0032501\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0008150\" -> \"GO:0032502\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0009791\" -> \"GO:0010228\" [color=\"darkgreen\", style=\"dashed\", tooltip=\"part_of\"];\n  \"GO:0022414\" -> \"GO:0003006\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0032501\" -> \"GO:0007275\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0032501\" -> \"GO:0009791\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0032502\" -> \"GO:0003006\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0032502\" -> \"GO:0048856\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0048608\" -> \"GO:0010228\" [color=\"darkgreen\", style=\"dashed\", tooltip=\"part_of\"];\n  \"GO:0048731\" -> \"GO:0061458\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0048856\" -> \"GO:0007275\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0048856\" -> \"GO:0048608\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0048856\" -> \"GO:0048731\" [color=\"purple\", style=\"solid\", tooltip=\"is_a\"];\n  \"GO:0061458\" -> \"GO:0048608\" [color=\"darkgreen\", style=\"dashed\", tooltip=\"part_of\"];\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="huge-dags">Huge DAGs<a class="anchor" aria-label="anchor" href="#huge-dags"></a>
</h2>
<p>Visualizing huge DAGs is not an easy job because a term can have more than one parents. Here the <code><a href="../reference/dag_viz.html">dag_circular_viz()</a></code> uses a circular layout to visualize huge DAGs.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dag_viz.html">dag_circular_viz</a></span><span class="op">(</span><span class="va">dag</span><span class="op">)</span></span></code></pre></div>
<p><img src="v7_dag_visualization_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"></p>
<p>In the circular layout, each circle correspond to a specific depth (maximal distance to root). On each circle, each term has a width (or a sector on the circle) associated where offspring terms are only drawn within that section. The width is proportional to the number of offspring terms of the term. Dot size corresponds to the number of child terms. If colors are not set, let’s say root term is on level 0, the DAG is cut at level-0 terms (links between level-1 terms and level-0 terms are all cut), and each sub-DAG is assigned with a different color. A legend of top terms of sub-DAGs is also added in the plot.</p>
<p>The term IDs are not informative in the plot. If there are additional information of terms stored in the meta data frame of the DAG object, the column name can be set with the <code>legend_labels_from</code> argument.</p>
<p>Especially for the GO DAG, we can observe that there are many links connecting sub-DAGs. To reduce such disturbance from cross-DAG links, on different levels of terms, we can reorder their child terms so that sub-DAGs are places closer to each other if there exist a large number of cross-DAG links. Normally, such reordering on child terms should be not applied too deep in the DAG because the effect of deeper terms are very subtile. In the following example, the reordering is only applied untile level 3.</p>
<p>The reordering is applied as follows, Denote a term <span class="math inline">\(x\)</span> has several child terms, and <span class="math inline">\(t_i\)</span>, <span class="math inline">\(t_j\)</span> are its two child terms. Denote <span class="math inline">\(\mathcal{D}^+_i\)</span> and <span class="math inline">\(\mathcal{D}^+_j\)</span> are the sets of <span class="math inline">\(t_i\)</span> and <span class="math inline">\(t_j\)</span>’s offspring terms including <span class="math inline">\(t_i\)</span>, <span class="math inline">\(t_j\)</span> themselves. First calculate the number of links denoted as <span class="math inline">\(k_{i,j}\)</span> connecting terms in <span class="math inline">\(\mathcal{D}^+_i\)</span> and <span class="math inline">\(\mathcal{D}^+_j\)</span>.</p>
<p><span class="math display">\[ k_{i,j} = \sum_{a \in \mathcal{D}^+_i, b \in \mathcal{D}^+_j}{I(\mathrm{pa}(a, b))} \]</span></p>
<p>where <span class="math inline">\(I(\mathrm{pa}(a, b)) = 1\)</span> when <span class="math inline">\(a\)</span> is a parent of <span class="math inline">\(b\)</span>, or <span class="math inline">\(b\)</span> is a parent of <span class="math inline">\(a\)</span>, or else <span class="math inline">\(I(\mathrm{pa}(a, b)) = 0\)</span>.</p>
<p>Next convert to a distance measure:</p>
<p><span class="math display">\[ d_{i,j} = \lambda_\mathrm{edge} - k_{i,j} \]</span></p>
<p>where <span class="math inline">\(\lambda_\mathrm{edge}\)</span> is the total number of edges in the DAG. In this way, <span class="math inline">\(d_{i,j}\)</span> is a non-negative value and measures the closeness of two terms with regards to how close the two sub-DAGs are. Finally, with the distance matrix of all child terms, TSP (travel salesman problem) is applied to reorder the child terms.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dag_viz.html">dag_circular_viz</a></span><span class="op">(</span><span class="va">dag</span>, reorder_level <span class="op">=</span> <span class="fl">3</span>, legend_labels_from <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span></span></code></pre></div>
<p><img src="v7_dag_visualization_files/figure-html/unnamed-chunk-9-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Or you can do reordering explicitly:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">dag</span>, reorder_level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/dag_viz.html">dag_circular_viz</a></span><span class="op">(</span><span class="va">dag</span>, legend_labels_from <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span></span></code></pre></div>
<p>One useful application is to map GO terms of interest (e.g. significant GO terms from function enrichment analysis) to the DAG. In the following example, <code>sig_go_ids</code> contains 249 significant GO terms from an enrichment analysis.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sig_go_ids</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sig_go_ids.rds"</span>, package <span class="op">=</span> <span class="st">"simona"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/dag_viz.html">dag_circular_viz</a></span><span class="op">(</span><span class="va">dag</span>, highlight <span class="op">=</span> <span class="va">sig_go_ids</span>, reorder_level <span class="op">=</span> <span class="fl">3</span>, </span>
<span>  legend_labels_from <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span></span></code></pre></div>
<p><img src="v7_dag_visualization_files/figure-html/unnamed-chunk-10-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.0 (2022-04-22)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin17.0 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Big Sur/Monterey 10.16</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib</span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] simona_0.99.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] Biobase_2.58.0         httr_1.4.6             sass_0.4.7            </span></span>
<span><span class="co">##  [4] bit64_4.0.5            jsonlite_1.8.7         foreach_1.5.2         </span></span>
<span><span class="co">##  [7] bslib_0.5.0            highr_0.10             stats4_4.2.0          </span></span>
<span><span class="co">## [10] blob_1.2.4             GenomeInfoDbData_1.2.9 yaml_2.3.7            </span></span>
<span><span class="co">## [13] RSQLite_2.3.1          glue_1.6.2             digest_0.6.33         </span></span>
<span><span class="co">## [16] RColorBrewer_1.1-3     XVector_0.38.0         colorspace_2.1-0      </span></span>
<span><span class="co">## [19] htmltools_0.5.5        pkgconfig_2.0.3        GetoptLong_1.1.0      </span></span>
<span><span class="co">## [22] DiagrammeR_1.0.10      zlibbioc_1.44.0        purrr_1.0.1           </span></span>
<span><span class="co">## [25] GO.db_3.16.0           KEGGREST_1.38.0        IRanges_2.32.0        </span></span>
<span><span class="co">## [28] ellipsis_0.3.2         cachem_1.0.8           BiocGenerics_0.44.0   </span></span>
<span><span class="co">## [31] cli_3.6.1              magrittr_2.0.3         crayon_1.5.2          </span></span>
<span><span class="co">## [34] memoise_2.0.1          evaluate_0.21          fs_1.6.2              </span></span>
<span><span class="co">## [37] doParallel_1.0.17      xml2_1.3.5             textshaping_0.3.6     </span></span>
<span><span class="co">## [40] tools_4.2.0            GlobalOptions_0.1.2    lifecycle_1.0.3       </span></span>
<span><span class="co">## [43] matrixStats_1.0.0      ComplexHeatmap_2.15.4  stringr_1.5.0         </span></span>
<span><span class="co">## [46] S4Vectors_0.36.2       cluster_2.1.4          AnnotationDbi_1.60.2  </span></span>
<span><span class="co">## [49] Biostrings_2.66.0      compiler_4.2.0         pkgdown_2.0.7         </span></span>
<span><span class="co">## [52] jquerylib_0.1.4        GenomeInfoDb_1.34.9    systemfonts_1.0.4     </span></span>
<span><span class="co">## [55] rlang_1.1.1            grid_4.2.0             RCurl_1.98-1.12       </span></span>
<span><span class="co">## [58] iterators_1.0.14       rstudioapi_0.15.0      rjson_0.2.21          </span></span>
<span><span class="co">## [61] htmlwidgets_1.6.2      visNetwork_2.1.2       circlize_0.4.16       </span></span>
<span><span class="co">## [64] igraph_1.5.0           bitops_1.0-7           rmarkdown_2.23        </span></span>
<span><span class="co">## [67] codetools_0.2-19       DBI_1.1.3              TSP_1.2-4             </span></span>
<span><span class="co">## [70] R6_2.5.1               knitr_1.43             fastmap_1.1.1         </span></span>
<span><span class="co">## [73] bit_4.0.5              clue_0.3-64            rprojroot_2.0.3       </span></span>
<span><span class="co">## [76] ragg_1.2.5             shape_1.4.6            desc_1.4.2            </span></span>
<span><span class="co">## [79] stringi_1.7.12         Polychrome_1.5.1       parallel_4.2.0        </span></span>
<span><span class="co">## [82] Rcpp_1.0.11            vctrs_0.6.3            png_0.1-8             </span></span>
<span><span class="co">## [85] scatterplot3d_0.3-44   xfun_0.39</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
